%!TEX root = ../main.tex


\chapter*{Conclusions}
\addcontentsline{toc}{chapter}{Conclusions} 
In this thesis, we have introduced new graph-based instance segmentation methods and applied them to automated segmentation of large neural tissue 3D image volumes. 
Until a few years ago, most of the instance segmentation pipelines employed in neuron segmentation consisted of several post-processing steps \cite{lee2017superhuman,funke2018large,beier2017multicut,funke2018candidate,pape2017solving,meirovitch2016multi,liu2016sshmt}. Many of these pipelines included a fully convolutional neural network trained to delineate boundaries between different neuronal processes in the image. These boundary predictions were first processed by a superpixel-generation algorithm, which would then return an over-segmentation, i.e., a segmentation where all pixels in an image's segment belong to the same neuronal process, but there can be many segments associated with one neuron. This initial over-segmentation was then converted into a graph whose nodes represented superpixels, whereas edges expressed neighboring relationships. Finally, a graph partitioning algorithm returned the final instance segmentation. 

These pipelines were rather complex and required the user to spend time tuning task-dependent hyper-parameters related to the superpixel generation algorithm. However, they used to be necessary to achieve state-of-the-art results because, at the time, deep learning models would often predict inconsistent boundaries, including holes and gaps. A way to fix this problem was then to generate superpixels and accumulate the model's predictions along boundaries separating the segments so that noise would be average out. 

Recently, the performances of fully convolutional models have dramatically improved, primarily thanks to novel training strategies \cite{lee2017superhuman,milletari2016v}. Many instance segmentation methods now predict pixel-pair affinities \cite{Gao_2019_ICCV,liu2018affinity,lee2017superhuman}, representing how likely it is for a pair of pixels to be in the same object instance. These approaches do not only predict affinities for pairs of direct-neighboring pixels: they also learn affinities between distant pixels. Predicting such long-range relations proved to be very beneficial during training because the model learns to more effectively detect large-scale features in images \cite{lee2017superhuman}. 

In this thesis, we have developed several new graph partitioning algorithms that are simple and parameter-free. 
By combining these algorithms with short- and long-range affinities from a deep convolutional neural network, we have shown that it is now possible to achieve state-of-the-art accuracies on neuron segmentation without relying on superpixels or other dataset-dependent post-processing pipelines.

In Chapter ~\ref{chapter:MWS}, we have introduced a new efficient algorithm, the Mutex Watershed, to cluster graphs with both attractive and repulsive edge weights. The proposed algorithm has low computational complexity and is closely related to Kruskal's algorithm for minimum spanning tree computation \cite{kruskal1956shortest}.
We prove that this algorithm finds the global optimum of an objective function and that this objective is closely related to the multicut optimization problem and the power watershed framework.
The Mutex Watershed algorithm achieved state-of-the-art results on the ISBI neuron segmentation challenge. After our results were published, it also became part of two other state-of-the-art segmentation pipelines used for neuron segmentation \cite{hirsch2020patchperpix,lee2019learning}.

In Chapter \ref{chapter:GASP}, we have then proved that the Mutex Watershed algorithm is part of a larger generalized framework, named GASP, for agglomerative clustering of graphs with both positive and negative edge weights. We have analyzed several theoretical and empirical properties of the algorithms in it, by exploring new and existing combinations of linkage criteria and applying them to different types of graphs. Algorithms based on an average linkage criterion proved to be simple and robust approaches when applied to an instance segmentation task. On large volume images, these simple average agglomeration algorithms achieved state-of-the-art results on the competitive CREMI neuron segmentation challenge. 

Finally, in Chapter \ref{chapter:LSI}, we introduced a novel proposal-free method predicting encoded single-instance masks in a sliding window style, one for each pixel of the input image, and introduced a parameter-free approach to aggregate predictions from overlapping masks and obtain all instances concurrently. The resulting pipeline proved to be strongly robust to noise when applied to large neuron segmentation volumetric images. 
The method also endows its predictions with an uncertainty measure, depending on the consensus of overlapping single-instance masks. Future work could use these uncertainty measures to estimate the confidence of individual instances, which may help facilitate the subsequent proof-reading step still needed in neuron segmentation.

The proposed unifying framework for agglomerative clustering algorithms also opens several opportunities for further research. Future work could investigate which objectives are optimized by the algorithms included in the GASP framework and study how they relate to the multicut / correlation clustering problem. A generalized GASP objective function could also be linked to existing cost functions for hierarchical clustering on unsigned graphs with positive edge weights \cite{moseley2017approximation,cohen2019hierarchical,dasgupta2016cost}. 
Another research direction is the structured learning of graph edge weights, which optimizes the segmentation performance directly. The fact that this approach has already been successfully applied to instance segmentation and other graph partitioning algorithms \cite{funke2018large,kong2018recurrentPix,wolf2017learned,cerrone2019end} suggests that it could be similarly used to achieve an end-to-end training of the segmentation pipelines presented in this thesis that rely on agglomerative algorithms in the GASP framework.

